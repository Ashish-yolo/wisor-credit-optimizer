"use strict";(()=>{var r={};r.id=613,r.ids=[613],r.modules={517:r=>{r.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3685:r=>{r.exports=require("http")},5687:r=>{r.exports=require("https")},4577:r=>{r.exports=require("punycode")},2781:r=>{r.exports=require("stream")},7310:r=>{r.exports=require("url")},9796:r=>{r.exports=require("zlib")},8664:(r,e,t)=>{t.r(e),t.d(e,{headerHooks:()=>g,originalPathname:()=>I,patchFetch:()=>j,requestAsyncStorage:()=>p,routeModule:()=>l,serverHooks:()=>m,staticGenerationAsyncStorage:()=>h,staticGenerationBailout:()=>f});var a={};t.r(a),t.d(a,{GET:()=>u,POST:()=>c});var s=t(884),o=t(6132),i=t(1040),n=t(5798),d=t(1762);async function u(r){try{let e=r.headers.get("authorization");if(!e||!e.startsWith("Bearer "))return n.Z.json({error:"Unauthorized"},{status:401});let t=e.split(" ")[1],{data:{user:a},error:s}=await d.O.auth.getUser(t);if(s||!a)return n.Z.json({error:"Invalid token"},{status:401});let{data:o,error:i}=await d.O.from("cards").select("*").eq("user_id",a.id).order("created_at",{ascending:!1});if(i)return console.error("Database error:",i),n.Z.json({error:"Failed to fetch cards"},{status:500});return n.Z.json({cards:o})}catch(r){return console.error("API error:",r),n.Z.json({error:"Internal server error"},{status:500})}}async function c(r){try{let e=r.headers.get("authorization");if(!e||!e.startsWith("Bearer "))return n.Z.json({error:"Unauthorized"},{status:401});let t=e.split(" ")[1],{data:{user:a},error:s}=await d.O.auth.getUser(t);if(s||!a)return n.Z.json({error:"Invalid token"},{status:401});let o=await r.json(),{cards:i}=o;if(!i||!Array.isArray(i)||0===i.length)return n.Z.json({error:"Cards array is required"},{status:400});for(let r of i){if(!r.card_name||!r.network||!r.card_last4)return n.Z.json({error:"All cards must have card_name, network, and card_last4"},{status:400});if(!/^\d{4}$/.test(r.card_last4))return n.Z.json({error:"card_last4 must be exactly 4 digits"},{status:400})}let u=i.map(r=>({user_id:a.id,card_name:r.card_name,network:r.network,card_last4:r.card_last4})),{data:c,error:l}=await d.O.from("cards").insert(u).select();if(l)return console.error("Database error:",l),n.Z.json({error:"Failed to add cards"},{status:500});return n.Z.json({cards:c,message:`Successfully added ${c.length} card(s)`},{status:201})}catch(r){return console.error("API error:",r),n.Z.json({error:"Internal server error"},{status:500})}}let l=new s.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/cards/route",pathname:"/api/cards",filename:"route",bundlePath:"app/api/cards/route"},resolvedPagePath:"/Users/ashishshekhawat/Desktop/wisor-credit-optimizer/wisor-web-app/src/app/api/cards/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:p,staticGenerationAsyncStorage:h,serverHooks:m,headerHooks:g,staticGenerationBailout:f}=l,I="/api/cards/route";function j(){return(0,i.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:h})}},1762:(r,e,t)=>{t.d(e,{O:()=>s});var a=t(8935);let s=(0,a.eI)("https://gpqdzgfnkepeexdgtrda.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdwcWR6Z2Zua2VwZWV4ZGd0cmRhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg5NjAxOTgsImV4cCI6MjA3NDUzNjE5OH0.4iOn2YvvBREMPOF-NHk3X3t2OxgPrz9gm2UJVg3RapU")}};var e=require("../../../webpack-runtime.js");e.C(r);var t=r=>e(e.s=r),a=e.X(0,[271,350],()=>t(8664));module.exports=a})();