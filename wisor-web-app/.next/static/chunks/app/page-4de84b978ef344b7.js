(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{8548:function(e,t,s){Promise.resolve().then(s.bind(s,6711))},6711:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return D}});var a=s(7437),r=s(2265),l=s(5257);let n=(0,l.eI)("https://gpqdzgfnkepeexdgtrda.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdwcWR6Z2Zua2VwZWV4ZGd0cmRhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg5NjAxOTgsImV4cCI6MjA3NDUzNjE5OH0.4iOn2YvvBREMPOF-NHk3X3t2OxgPrz9gm2UJVg3RapU");var i=s(2741),d=s(8291),o=s(5925);function c(e){let{onOTPSent:t}=e,[s,l]=(0,r.useState)(""),[c,m]=(0,r.useState)(!1),u=e=>{let t=e.replace(/\D/g,""),s=t.slice(0,10);return s.length>=6?"".concat(s.slice(0,3),"-").concat(s.slice(3,6),"-").concat(s.slice(6)):s.length>=3?"".concat(s.slice(0,3),"-").concat(s.slice(3)):s},x=async e=>{e.preventDefault();let a=s.replace(/\D/g,"");if(10!==a.length){o.default.error("Please enter a valid 10-digit mobile number");return}m(!0);try{let{error:e}=await n.auth.signInWithOtp({phone:"+91".concat(a),options:{channel:"sms"}});if(e)throw e;o.default.success("OTP sent successfully!"),t("+91".concat(a))}catch(e){console.error("Login error:",e),o.default.error(e.message||"Failed to send OTP. Please try again.")}finally{m(!1)}};return(0,a.jsx)("div",{className:"w-full max-w-md mx-auto",children:(0,a.jsxs)("div",{className:"bg-white/80 backdrop-blur-md border border-white/20 shadow-2xl rounded-3xl p-8",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-500 rounded-2xl flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)("span",{className:"text-white font-bold text-2xl",children:"W"})}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-slate-800 mb-2",children:"Welcome to Wisor"}),(0,a.jsx)("p",{className:"text-slate-600",children:"Enter your mobile number to get started"})]}),(0,a.jsxs)("form",{onSubmit:x,className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"phone",className:"block text-sm font-medium text-slate-700 mb-2",children:"Mobile Number"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)(i.Z,{className:"h-5 w-5 text-slate-400"})}),(0,a.jsx)("div",{className:"absolute inset-y-0 left-10 flex items-center pointer-events-none",children:(0,a.jsx)("span",{className:"text-slate-500 text-sm",children:"+91"})}),(0,a.jsx)("input",{id:"phone",type:"tel",value:s,onChange:e=>{let t=u(e.target.value);l(t)},placeholder:"XXX-XXX-XXXX",className:"block w-full pl-20 pr-3 py-3 border border-slate-300 rounded-xl shadow-sm placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-lg",required:!0})]}),(0,a.jsx)("p",{className:"mt-1 text-xs text-slate-500",children:"We'll send you an OTP to verify your number"})]}),(0,a.jsx)("button",{type:"submit",disabled:c||10!==s.replace(/\D/g,"").length,className:"w-full bg-gradient-to-r from-blue-500 to-purple-500 text-white py-3 px-4 rounded-xl font-semibold disabled:opacity-50 disabled:cursor-not-allowed hover:from-blue-600 hover:to-purple-600 transition-all duration-200 flex items-center justify-center group",children:c?(0,a.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"}):(0,a.jsxs)(a.Fragment,{children:["Send OTP",(0,a.jsx)(d.Z,{className:"ml-2 h-5 w-5 group-hover:translate-x-1 transition-transform"})]})})]}),(0,a.jsx)("div",{className:"mt-8 text-center text-xs text-slate-500",children:"By continuing, you agree to our Terms of Service and Privacy Policy"})]})})}var m=s(3067),u=s(2442);function x(e){let{phone:t,onBack:s,onVerified:l}=e,[i,d]=(0,r.useState)(["","","","","",""]),[c,x]=(0,r.useState)(!1),[h,b]=(0,r.useState)(30),p=(0,r.useRef)([]);(0,r.useEffect)(()=>{if("OTPCredential"in window){let e=new AbortController;return navigator.credentials.get({otp:{transport:["sms"]},signal:e.signal}).then(e=>{if(e&&e.code){let s=e.code,a=s.split("").slice(0,6);if(d(a),6===a.length&&a.every(e=>""!==e)){var t;null===(t=p.current[5])||void 0===t||t.focus()}}}).catch(e=>{console.log("OTP auto-fill not available:",e)}),()=>e.abort()}},[]),(0,r.useEffect)(()=>{if(h>0){let e=setTimeout(()=>b(h-1),1e3);return()=>clearTimeout(e)}},[h]);let f=(e,t)=>{let s=t.replace(/\D/g,"").slice(-1),a=[...i];if(a[e]=s,d(a),s&&e<5){var r;null===(r=p.current[e+1])||void 0===r||r.focus()}},g=(e,t)=>{if("Backspace"===t.key&&!i[e]&&e>0){var s;null===(s=p.current[e-1])||void 0===s||s.focus()}},j=e=>{var t;e.preventDefault();let s=e.clipboardData.getData("text").replace(/\D/g,"").slice(0,6),a=s.split(""),r=[...i];a.forEach((e,t)=>{t<6&&(r[t]=e)}),d(r);let l=Math.min(a.length,5);null===(t=p.current[l])||void 0===t||t.focus()},v=async e=>{e.preventDefault();let s=i.join("");if(6!==s.length){o.default.error("Please enter complete 6-digit OTP");return}x(!0);try{let{data:e,error:a}=await n.auth.verifyOtp({phone:t,token:s,type:"sms"});if(a)throw a;e.user&&(o.default.success("Phone number verified successfully!"),l())}catch(e){var a;console.error("OTP verification error:",e),o.default.error(e.message||"Invalid OTP. Please try again."),d(["","","","","",""]),null===(a=p.current[0])||void 0===a||a.focus()}finally{x(!1)}},w=async()=>{if(!(h>0))try{var e;let{error:s}=await n.auth.signInWithOtp({phone:t,options:{channel:"sms"}});if(s)throw s;o.default.success("OTP sent again!"),b(30),d(["","","","","",""]),null===(e=p.current[0])||void 0===e||e.focus()}catch(e){console.error("Resend OTP error:",e),o.default.error(e.message||"Failed to resend OTP")}};return(0,a.jsx)("div",{className:"w-full max-w-md mx-auto",children:(0,a.jsxs)("div",{className:"bg-white/80 backdrop-blur-md border border-white/20 shadow-2xl rounded-3xl p-8",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("button",{onClick:s,className:"absolute top-6 left-6 p-2 hover:bg-slate-100 rounded-lg transition-colors",children:(0,a.jsx)(m.Z,{className:"h-5 w-5 text-slate-600"})}),(0,a.jsx)("div",{className:"w-16 h-16 bg-gradient-to-r from-green-500 to-blue-500 rounded-2xl flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)(u.Z,{className:"h-8 w-8 text-white"})}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-slate-800 mb-2",children:"Verify OTP"}),(0,a.jsxs)("p",{className:"text-slate-600",children:["We've sent a 6-digit code to",(0,a.jsx)("br",{}),(0,a.jsx)("span",{className:"font-semibold",children:t})]})]}),(0,a.jsxs)("form",{onSubmit:v,className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-4 text-center",children:"Enter 6-digit OTP"}),(0,a.jsx)("div",{className:"flex justify-center gap-3",children:i.map((e,t)=>(0,a.jsx)("input",{ref:e=>{p.current[t]=e},type:"text",value:e,onChange:e=>f(t,e.target.value),onKeyDown:e=>g(t,e),onPaste:0===t?j:void 0,className:"w-12 h-12 text-center text-xl font-semibold border border-slate-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",maxLength:1,autoComplete:"one-time-code"},t))})]}),(0,a.jsx)("button",{type:"submit",disabled:c||6!==i.join("").length,className:"w-full bg-gradient-to-r from-blue-500 to-purple-500 text-white py-3 px-4 rounded-xl font-semibold disabled:opacity-50 disabled:cursor-not-allowed hover:from-blue-600 hover:to-purple-600 transition-all duration-200",children:c?(0,a.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent mx-auto"}):"Verify & Continue"})]}),(0,a.jsx)("div",{className:"mt-6 text-center",children:h>0?(0,a.jsxs)("p",{className:"text-sm text-slate-500",children:["Resend OTP in ",h,"s"]}):(0,a.jsx)("button",{onClick:w,className:"text-sm text-blue-600 hover:text-blue-700 font-medium underline",children:"Didn't receive OTP? Resend"})})]})})}var h=s(1738),b=s(5367),p=s(9883),f=s(3523),g=s(1827),j=s(7042),v=s(4769);function w(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,v.m6)((0,j.W)(t))}function y(e){let{options:t,value:s,onChange:l,placeholder:n,label:i,searchPlaceholder:d="Search...",renderOption:o,error:c}=e,[m,x]=(0,r.useState)(!1),[h,b]=(0,r.useState)(""),p=(0,r.useRef)(null),j=(0,r.useRef)(null),v=t.filter(e=>e.name.toLowerCase().includes(h.toLowerCase())),y=t.find(e=>e.value===s);(0,r.useEffect)(()=>{function e(e){p.current&&!p.current.contains(e.target)&&(x(!1),b(""))}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,r.useEffect)(()=>{m&&j.current&&j.current.focus()},[m]);let N=e=>{l(e.value),x(!1),b("")};return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-slate-700",children:i}),(0,a.jsxs)("div",{className:"relative",ref:p,children:[(0,a.jsxs)("button",{type:"button",onClick:()=>{x(!m),b("")},className:w("relative w-full bg-white border rounded-xl shadow-sm pl-3 pr-10 py-3 text-left cursor-pointer focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",c?"border-red-300":"border-slate-300","hover:border-slate-400 transition-colors"),children:[(0,a.jsx)("span",{className:w("block truncate",y?"text-slate-900":"text-slate-400"),children:y?y.name:n}),(0,a.jsx)("span",{className:"absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none",children:(0,a.jsx)(f.Z,{className:w("h-5 w-5 text-slate-400 transition-transform",m&&"rotate-180")})})]}),m&&(0,a.jsxs)("div",{className:"absolute z-10 mt-1 w-full bg-white shadow-xl border border-slate-200 rounded-xl max-h-80 overflow-hidden",children:[(0,a.jsx)("div",{className:"p-3 border-b border-slate-200",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(g.Z,{className:"absolute left-3 top-3 h-4 w-4 text-slate-400"}),(0,a.jsx)("input",{ref:j,type:"text",value:h,onChange:e=>b(e.target.value),onKeyDown:e=>{"Escape"===e.key?(x(!1),b("")):"Enter"===e.key&&v.length>0&&(e.preventDefault(),N(v[0]))},placeholder:d,className:"w-full pl-10 pr-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})}),(0,a.jsx)("div",{className:"max-h-60 overflow-auto",children:v.length>0?v.map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>N(e),className:w("relative w-full text-left px-4 py-3 hover:bg-slate-50 focus:outline-none focus:bg-slate-50 transition-colors",s===e.value&&"bg-blue-50 text-blue-700"),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[o?o(e):(0,a.jsx)("span",{className:"block truncate",children:e.name}),s===e.value&&(0,a.jsx)(u.Z,{className:"h-4 w-4 text-blue-600 flex-shrink-0"})]})},e.id)):(0,a.jsxs)("div",{className:"px-4 py-6 text-center text-sm text-slate-500",children:['No results found for "',h,'"']})})]})]}),c&&(0,a.jsx)("p",{className:"text-sm text-red-600",children:c})]})}let N=[{id:"hdfc-regalia",name:"HDFC Regalia",bank:"HDFC",type:"Premium"},{id:"hdfc-millennia",name:"HDFC Millennia",bank:"HDFC",type:"Lifestyle"},{id:"hdfc-diners-black",name:"HDFC Diners Club Black",bank:"HDFC",type:"Super Premium"},{id:"hdfc-infinia",name:"HDFC Infinia",bank:"HDFC",type:"Super Premium"},{id:"hdfc-swiggy",name:"HDFC Swiggy",bank:"HDFC",type:"Co-branded"},{id:"hdfc-tata-neu-plus",name:"HDFC Tata Neu Plus",bank:"HDFC",type:"Co-branded"},{id:"icici-sapphiro",name:"ICICI Bank Sapphiro",bank:"ICICI",type:"Premium"},{id:"icici-emeralde",name:"ICICI Bank Emeralde",bank:"ICICI",type:"Super Premium"},{id:"icici-amazon-pay",name:"ICICI Amazon Pay",bank:"ICICI",type:"Co-branded"},{id:"icici-manchest-united",name:"ICICI Manchester United",bank:"ICICI",type:"Co-branded"},{id:"icici-mmt",name:"ICICI MakeMyTrip",bank:"ICICI",type:"Co-branded"},{id:"sbi-elite",name:"SBI Elite",bank:"SBI",type:"Premium"},{id:"sbi-prime",name:"SBI Prime",bank:"SBI",type:"Premium"},{id:"sbi-cashback",name:"SBI Cashback",bank:"SBI",type:"Cashback"},{id:"sbi-simply-click",name:"SBI SimplyCLICK",bank:"SBI",type:"Online Shopping"},{id:"axis-magnus",name:"Axis Magnus",bank:"Axis",type:"Super Premium"},{id:"axis-reserve",name:"Axis Reserve",bank:"Axis",type:"Ultra Premium"},{id:"axis-ace",name:"Axis ACE",bank:"Axis",type:"Cashback"},{id:"axis-flipkart",name:"Axis Flipkart",bank:"Axis",type:"Co-branded"},{id:"axis-myzone",name:"Axis MyZone",bank:"Axis",type:"Lifestyle"},{id:"kotak-zen",name:"Kotak Zen Signature",bank:"Kotak",type:"Premium"},{id:"kotak-league",name:"Kotak League Platinum",bank:"Kotak",type:"Premium"},{id:"kotak-royale",name:"Kotak Royale Signature",bank:"Kotak",type:"Super Premium"},{id:"yes-marquee",name:"Yes Marquee",bank:"Yes Bank",type:"Super Premium"},{id:"yes-elite-plus",name:"Yes Elite Plus",bank:"Yes Bank",type:"Premium"},{id:"yes-first-preferred",name:"Yes First Preferred",bank:"Yes Bank",type:"Premium"},{id:"rbl-icon",name:"RBL Icon",bank:"RBL",type:"Premium"},{id:"rbl-world-safari",name:"RBL World Safari",bank:"RBL",type:"Travel"},{id:"rbl-shoprite",name:"RBL ShopRite",bank:"RBL",type:"Shopping"},{id:"citi-prestige",name:"Citi Prestige",bank:"Citibank",type:"Super Premium"},{id:"citi-premier-miles",name:"Citi PremierMiles",bank:"Citibank",type:"Travel"},{id:"citi-rewards",name:"Citi Rewards",bank:"Citibank",type:"Rewards"},{id:"sc-platinum-rewards",name:"SC Platinum Rewards",bank:"Standard Chartered",type:"Rewards"},{id:"sc-super-value-titanium",name:"SC Super Value Titanium",bank:"Standard Chartered",type:"Value"},{id:"sc-manhattan",name:"SC Manhattan",bank:"Standard Chartered",type:"Premium"},{id:"amex-platinum-travel",name:"Amex Platinum Travel",bank:"American Express",type:"Super Premium"},{id:"amex-gold",name:"Amex Gold",bank:"American Express",type:"Premium"},{id:"amex-membership-rewards",name:"Amex Membership Rewards",bank:"American Express",type:"Rewards"}],k=[{id:"visa",name:"Visa",value:"visa"},{id:"mastercard",name:"Mastercard",value:"mastercard"},{id:"rupay",name:"RuPay",value:"rupay"},{id:"amex",name:"American Express",value:"amex"},{id:"diners",name:"Diners Club",value:"diners"}];function C(e){let{onCardsAdded:t,isLoading:s=!1}=e,[l,n]=(0,r.useState)([{id:"1",card_name:"",network:"",card_last4:""}]),i=e=>{l.length>1&&n(l.filter(t=>t.id!==e))},d=(e,t,s)=>{n(l.map(a=>a.id===e?{...a,[t]:s}:a))},c=(e,t)=>{let s=t.replace(/\D/g,"").slice(0,4);d(e,"card_last4",s)},m=()=>{let e=!0,t=l.filter(e=>e.card_name||e.network||e.card_last4);if(0===t.length)return o.default.error("Please add at least one card"),!1;for(let s of t){if(!s.card_name){o.default.error("Please select a card name for all cards"),e=!1;break}if(!s.network){o.default.error("Please select a network for all cards"),e=!1;break}if(4!==s.card_last4.length){o.default.error("Please enter 4 digits for all card numbers"),e=!1;break}}return e},u=e=>(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:e.name}),(0,a.jsxs)("div",{className:"text-sm text-slate-500",children:[e.bank," • ",e.type]})]}),x=e=>(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-8 h-5 bg-slate-100 rounded mr-3 flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-xs font-bold text-slate-600",children:e.name.charAt(0)})}),(0,a.jsx)("span",{children:e.name})]}),f=l.some(e=>e.card_name&&e.network&&4===e.card_last4.length);return(0,a.jsx)("div",{className:"w-full max-w-2xl mx-auto",children:(0,a.jsxs)("div",{className:"bg-white/80 backdrop-blur-md border border-white/20 shadow-2xl rounded-3xl p-8",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-gradient-to-r from-green-500 to-blue-500 rounded-2xl flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)(h.Z,{className:"h-8 w-8 text-white"})}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-slate-800 mb-2",children:"Add Your Credit Cards"}),(0,a.jsx)("p",{className:"text-slate-600",children:"Add one or more cards to get personalized recommendations"})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[l.map((e,t)=>(0,a.jsxs)("div",{className:"border border-slate-200 rounded-2xl p-6 bg-white/50",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-slate-800",children:["Card ",t+1]}),l.length>1&&(0,a.jsx)("button",{type:"button",onClick:()=>i(e.id),className:"p-2 text-red-500 hover:bg-red-50 rounded-lg transition-colors",children:(0,a.jsx)(b.Z,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,a.jsx)(y,{options:N.map(e=>({...e,value:e.id})),value:e.card_name,onChange:t=>d(e.id,"card_name",t),placeholder:"Select your card",label:"Card Name",searchPlaceholder:"Search cards...",renderOption:u}),(0,a.jsx)(y,{options:k,value:e.network,onChange:t=>d(e.id,"network",t),placeholder:"Select network",label:"Card Network",searchPlaceholder:"Search networks...",renderOption:x})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Last 4 Digits"}),(0,a.jsx)("input",{type:"text",value:e.card_last4,onChange:t=>c(e.id,t.target.value),placeholder:"1234",className:"w-full px-3 py-3 border border-slate-300 rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",maxLength:4,pattern:"[0-9]*",inputMode:"numeric"}),(0,a.jsx)("p",{className:"mt-1 text-xs text-slate-500",children:"Only the last 4 digits for identification"})]})]},e.id)),(0,a.jsxs)("button",{type:"button",onClick:()=>{let e={id:Date.now().toString(),card_name:"",network:"",card_last4:""};n([...l,e])},className:"w-full border-2 border-dashed border-slate-300 rounded-2xl p-6 text-slate-500 hover:border-blue-400 hover:text-blue-600 transition-colors group",children:[(0,a.jsx)(p.Z,{className:"h-6 w-6 mx-auto mb-2 group-hover:scale-110 transition-transform"}),(0,a.jsx)("span",{className:"font-medium",children:"Add Another Card"})]}),(0,a.jsx)("button",{onClick:()=>{if(!m())return;let e=l.filter(e=>e.card_name&&e.network&&4===e.card_last4.length).map(e=>{let{id:t,...s}=e;return s});t(e)},disabled:!f||s,className:w("w-full py-4 px-6 rounded-xl font-semibold transition-all duration-200",f&&!s?"bg-gradient-to-r from-blue-500 to-purple-500 text-white hover:from-blue-600 hover:to-purple-600 shadow-lg hover:shadow-xl":"bg-slate-300 text-slate-500 cursor-not-allowed"),children:s?(0,a.jsxs)("div",{className:"flex items-center justify-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent mr-2"}),"Adding Cards..."]}):"Continue with ".concat(l.filter(e=>e.card_name&&e.network&&4===e.card_last4.length).length," Card").concat(1!==l.filter(e=>e.card_name&&e.network&&4===e.card_last4.length).length?"s":"")})]}),(0,a.jsx)("div",{className:"mt-6 text-center text-xs text-slate-500",children:"Your card information is stored securely and only used for recommendations"})]})})}var P=s(5883),S=s(5817);function I(e){let{user:t,cards:s,onCardsUpdated:l}=e,[i,d]=(0,r.useState)(!1),c=async()=>{try{let{error:e}=await n.auth.signOut();if(e)throw e;o.default.success("Logged out successfully")}catch(e){console.error("Logout error:",e),o.default.error(e.message||"Failed to logout")}},m=async()=>{d(!0);try{await new Promise(e=>setTimeout(e,1e3));let e=document.createElement("a");e.href="/wisor-extension-v2.0-enhanced.zip",e.download="wisor-extension.zip",document.body.appendChild(e),e.click(),document.body.removeChild(e),o.default.success("Extension download started!")}catch(e){console.error("Download error:",e),o.default.error("Failed to download extension")}finally{d(!1)}},u=async e=>{try{let{error:a}=await n.from("cards").delete().eq("id",e).eq("user_id",t.id);if(a)throw a;let r=s.filter(t=>t.id!==e);l(r),o.default.success("Card deleted successfully")}catch(e){console.error("Delete error:",e),o.default.error(e.message||"Failed to delete card")}},x=e=>N.find(t=>t.id===e)||{name:e,bank:"Unknown",type:"Credit Card"},f=e=>k.find(t=>t.value===e)||{name:e,value:e};return(0,a.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,a.jsx)("div",{className:"bg-white/80 backdrop-blur-md border border-white/20 shadow-2xl rounded-3xl p-8 mb-8",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-500 rounded-2xl flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white font-bold text-2xl",children:"W"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-slate-800",children:"Welcome to Wisor"}),(0,a.jsx)("p",{className:"text-slate-600",children:t.phone})]})]}),(0,a.jsxs)("button",{onClick:c,className:"flex items-center space-x-2 px-4 py-2 text-slate-600 hover:text-slate-800 hover:bg-slate-100 rounded-lg transition-colors",children:[(0,a.jsx)(P.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Logout"})]})]})}),(0,a.jsx)("div",{className:"bg-white/80 backdrop-blur-md border border-white/20 shadow-2xl rounded-3xl p-8 mb-8",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-20 h-20 bg-gradient-to-r from-green-500 to-blue-500 rounded-2xl flex items-center justify-center mx-auto mb-6",children:(0,a.jsx)(S.Z,{className:"h-10 w-10 text-white"})}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-slate-800 mb-4",children:"Download Wisor Extension"}),(0,a.jsx)("p",{className:"text-slate-600 mb-6 max-w-2xl mx-auto",children:"Your cards are ready! Download the Wisor Chrome extension to get AI-powered recommendations while shopping online."}),(0,a.jsx)("button",{onClick:m,disabled:i,className:"bg-gradient-to-r from-blue-500 to-purple-500 text-white py-4 px-8 rounded-2xl font-semibold disabled:opacity-50 disabled:cursor-not-allowed hover:from-blue-600 hover:to-purple-600 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105 inline-flex items-center text-lg",children:i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent mr-3"}),"Preparing Download..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(S.Z,{className:"mr-3 h-6 w-6"}),"Download Wisor!"]})}),(0,a.jsx)("p",{className:"text-slate-500 text-sm mt-4",children:"Start Savings today"})]})}),(0,a.jsxs)("div",{className:"bg-white/80 backdrop-blur-md border border-white/20 shadow-2xl rounded-3xl p-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("h2",{className:"text-2xl font-bold text-slate-800 flex items-center",children:[(0,a.jsx)(h.Z,{className:"mr-3 h-6 w-6"}),"Your Cards (",s.length,")"]}),(0,a.jsxs)("button",{className:"flex items-center space-x-2 px-4 py-2 text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded-lg transition-colors",children:[(0,a.jsx)(p.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Add Card"})]})]}),s.length>0?(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(e=>{let t=x(e.card_name),s=f(e.network||"");return(0,a.jsxs)("div",{className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-2xl p-6 text-white relative overflow-hidden",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-white/5 to-transparent"}),(0,a.jsxs)("div",{className:"relative z-10",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"font-semibold text-lg leading-tight",children:t.name}),(0,a.jsx)("p",{className:"text-slate-300 text-sm",children:t.bank})]}),(0,a.jsx)("button",{onClick:()=>u(e.id),className:"p-2 hover:bg-white/10 rounded-lg transition-colors",children:(0,a.jsx)(b.Z,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("p",{className:"text-slate-300 text-sm mb-1",children:"Card Number"}),(0,a.jsxs)("p",{className:"font-mono text-lg",children:["•••• •••• •••• ",e.card_last4]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-slate-300 text-xs",children:"Network"}),(0,a.jsx)("p",{className:"font-semibold",children:s.name})]}),(0,a.jsx)("div",{className:"w-12 h-8 bg-white/10 rounded flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-xs font-bold",children:s.name.charAt(0)})})]})]})]},e.id)})}):(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(h.Z,{className:"h-16 w-16 text-slate-400 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-slate-800 mb-2",children:"No Cards Added"}),(0,a.jsx)("p",{className:"text-slate-600 mb-6",children:"Add your first credit card to get started"}),(0,a.jsx)("button",{className:"bg-gradient-to-r from-blue-500 to-purple-500 text-white py-3 px-6 rounded-xl font-semibold hover:from-blue-600 hover:to-purple-600 transition-all duration-200",children:"Add Your First Card"})]})]}),(0,a.jsxs)("div",{className:"mt-8 bg-blue-50 border border-blue-200 rounded-2xl p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-blue-800 mb-3",children:"\uD83D\uDCCB Next Steps"}),(0,a.jsxs)("ol",{className:"list-decimal list-inside space-y-2 text-blue-700",children:[(0,a.jsx)("li",{children:"Download the Wisor Chrome extension using the button above"}),(0,a.jsx)("li",{children:"Extract the ZIP file to a folder on your computer"}),(0,a.jsx)("li",{children:"Open Chrome and go to chrome://extensions"}),(0,a.jsx)("li",{children:'Enable "Developer mode" and click "Load unpacked"'}),(0,a.jsx)("li",{children:"Select the extracted folder and start shopping!"})]})]})]})}function D(){let[e,t]=(0,r.useState)("loading"),[s,l]=(0,r.useState)({user:null,isLoading:!0}),[i,d]=(0,r.useState)(""),[m,u]=(0,r.useState)([]);(0,r.useEffect)(()=>{h();let{data:{subscription:e}}=n.auth.onAuthStateChange(async(e,s)=>{"SIGNED_IN"===e&&s?(l({user:s.user,isLoading:!1}),await b(s.user.id)):"SIGNED_OUT"===e&&(l({user:null,isLoading:!1}),t("login"),u([]))});return()=>e.unsubscribe()},[]);let h=async()=>{try{let{data:{session:e},error:s}=await n.auth.getSession();if(s){console.error("Session error:",s),l({user:null,isLoading:!1}),t("login");return}e?(l({user:e.user,isLoading:!1}),await b(e.user.id)):(l({user:null,isLoading:!1}),t("login"))}catch(e){console.error("Error checking session:",e),l({user:null,isLoading:!1}),t("login")}},b=async e=>{try{let{data:s,error:a}=await n.from("cards").select("*").eq("user_id",e);if(a){console.error("Error fetching cards:",a),t("add-cards");return}u(s||[]),s&&s.length>0?t("dashboard"):t("add-cards")}catch(e){console.error("Error checking user cards:",e),t("add-cards")}},p=async e=>{if(s.user)try{let{data:a,error:r}=await n.from("cards").insert(e.map(e=>({user_id:s.user.id,...e}))).select();if(r)throw r;u(a),t("dashboard"),o.default.success("Successfully added ".concat(a.length," card(s)!"))}catch(e){console.error("Error adding cards:",e),o.default.error(e.message||"Failed to add cards")}};return s.isLoading||"loading"===e?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)("div",{className:"bg-white/80 backdrop-blur-md border border-white/20 shadow-2xl rounded-3xl p-8",children:(0,a.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-500 rounded-2xl flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white font-bold text-2xl",children:"W"})}),(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-blue-500 border-t-transparent"}),(0,a.jsx)("p",{className:"text-slate-600",children:"Loading Wisor..."})]})})}):(0,a.jsx)("main",{className:"min-h-screen py-12 px-4",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto",children:["login"===e&&(0,a.jsx)(c,{onOTPSent:e=>{d(e),t("otp")}}),"otp"===e&&(0,a.jsx)(x,{phone:i,onBack:()=>{t("login"),d("")},onVerified:()=>{}}),"add-cards"===e&&(0,a.jsx)(C,{onCardsAdded:p}),"dashboard"===e&&(0,a.jsx)(I,{user:s.user,cards:m,onCardsUpdated:u})]})})}}},function(e){e.O(0,[969,971,472,744],function(){return e(e.s=8548)}),_N_E=e.O()}]);